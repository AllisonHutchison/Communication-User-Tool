'use strict';
<<<<<<< HEAD
var call = require('../internals/function-call');
var aCallable = require('../internals/a-callable');
=======
>>>>>>> 39a8ac91c1203e59702c1b86c18a4c5e5058db03
var anObject = require('../internals/an-object');

// `Map.prototype.emplace` method
// https://github.com/thumbsupep/proposal-upsert
module.exports = function emplace(key, handler) {
  var map = anObject(this);
<<<<<<< HEAD
  var get = aCallable(map.get);
  var has = aCallable(map.has);
  var set = aCallable(map.set);
  var value = (call(has, map, key) && 'update' in handler)
    ? handler.update(call(get, map, key), key, map)
    : handler.insert(key, map);
  call(set, map, key, value);
=======
  var value = (map.has(key) && 'update' in handler)
    ? handler.update(map.get(key), key, map)
    : handler.insert(key, map);
  map.set(key, value);
>>>>>>> 39a8ac91c1203e59702c1b86c18a4c5e5058db03
  return value;
};
